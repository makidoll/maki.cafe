<html>
	<head>
		<title>Save the Baby</title>
		<link href="https://fonts.googleapis.com/css?family=Roboto:400,700|Vibur" rel="stylesheet">
		<style>
			body {
				margin: 0;
				background-color: #FFF;
			}
			
			#view {
				position: fixed; margin: auto;
				top: 0; right: 0; left: 240px; bottom: 0;
				width: 853px;
				height: 480px;
				border-radius: 16px;
				z-index: 1000;
				background-color: #1d1f21;
			}
			
			#extra {
				position: absolute; margin: auto;
				left: 0; top: 0; bottom: 0;
				padding: 20px;
				width: 200px;
				z-index: 2000;
				font-family: "Roboto";
				text-align: left;
				background-color: #1d1f21;
				color: #fff;
			}
			
			#select {
				margin: 0;
			}
			
			#under-view {
				position: fixed; margin: auto;
				top: 548px; right: 0; left: 240px; bottom: 0;
				height: 34px;
				text-align: center;
			}
			
			h1 {
				font-size: 32px;
				line-height: 34px;
				margin: 0;
				font-weight: 400;
				font-family: "Roboto";
			}
			
			p {
				margin: 0;
				color: #fff;
			}

			input {
				border: none;
				padding: 2px 4px;
				text-align: left;
				font-weight: 400;
				font-family: "Roboto";
				border-radius: 4px;
			}

			.space {
				margin-bottom: 20px;
			}

			.b { 
				font-weight: 700;
			}
		</style>
	</head>
	<body>
		<canvas id="view"></canvas>
		<div id="under-view">
			<h1>Press <span class="b">SPACE</span> to save the <span id="thing">baby</span>!</h1>
		</div>
		<div id="extra">
			<svg xmlns="http://www.w3.org/2000/svg" width="100%" viewBox="0 0 320.8 231.8" style="fill: #FFF;"><path d="M0,231.8V107H24.2a87.1,87.1,0,0,1,13.6,1A26,26,0,0,1,50,113.8a31.3,31.3,0,0,1,9.5,12.6,39.5,39.5,0,0,1,3.2,15.6,31.9,31.9,0,0,1-3.2,14.7,30.6,30.6,0,0,1-10.2,11.1,21.3,21.3,0,0,1,6.7,5,30.4,30.4,0,0,1,4.8,7.2,39.5,39.5,0,0,1,2.9,8.4,37.9,37.9,0,0,1,1,8.4,36,36,0,0,1-3.2,15.9,30.9,30.9,0,0,1-8.7,10.9,35.2,35.2,0,0,1-12.9,6.3,61.5,61.5,0,0,1-15.9,2H0Zm39.4-89.4q0-7-3.8-11t-10.9-3.7v30.5q7,0,10.8-4.3T39.4,142.4Zm1,51.5a17.3,17.3,0,0,0-4.2-12q-4.2-4.7-11.5-4.6v33.8q7.4,0.3,11.6-4.5T40.4,193.9Z"/><path d="M126.8,107l30,124.8H130.4l-4.6-21h-25l-4.5,21H71.8l29-124.8h26Zm-10.9,51-2.8-18.9h-0.3L110.1,158l-5.3,33.3h17.4Z"/><path d="M166.7,231.8V107h24.2a87.1,87.1,0,0,1,13.6,1,26,26,0,0,1,12.3,5.8,31.3,31.3,0,0,1,9.5,12.6,39.5,39.5,0,0,1,3.2,15.6,31.9,31.9,0,0,1-3.2,14.7A30.6,30.6,0,0,1,216,167.8a21.3,21.3,0,0,1,6.7,5,30.4,30.4,0,0,1,4.8,7.2,39.5,39.5,0,0,1,2.9,8.4,37.9,37.9,0,0,1,1,8.4,36,36,0,0,1-3.2,15.9,30.9,30.9,0,0,1-8.7,10.9,35.2,35.2,0,0,1-12.9,6.3,61.5,61.5,0,0,1-15.9,2h-24Zm39.4-89.4q0-7-3.8-11t-10.9-3.7v30.5q7,0,10.8-4.3T206.1,142.4Zm1,51.5a17.3,17.3,0,0,0-4.2-12q-4.2-4.7-11.5-4.6v33.8q7.4,0.3,11.6-4.5T207.1,193.9Z"/><path d="M264,107L277,140.9l1.8,6.1h0.3l2.8-9.3L293,107h27.6l-29.1,65.1v59.8H266.9V172.1l-30-65.1H264Z"/><path d="M42.3,23.4A32.8,32.8,0,0,0,35.9,19a16,16,0,0,0-7.5-1.8,9.7,9.7,0,0,0-7.1,2.5,9.3,9.3,0,0,0-2.6,7A11.1,11.1,0,0,0,21,33.6a32.6,32.6,0,0,0,5.4,5.5q3.2,2.6,7,5.3a43,43,0,0,1,7,6.1,31.9,31.9,0,0,1,5.4,8.1,26,26,0,0,1,2.2,11.2,38.4,38.4,0,0,1-1.8,12,26.7,26.7,0,0,1-5.4,9.6,25.4,25.4,0,0,1-8.8,6.4A29,29,0,0,1,20.1,100a32.9,32.9,0,0,1-8.6-1.2,23.6,23.6,0,0,1-7.8-3.7V76.9a35.5,35.5,0,0,0,6.8,3.7A20.2,20.2,0,0,0,18.1,82,11.4,11.4,0,0,0,26,79.2a9.7,9.7,0,0,0,3.2-7.7,10.4,10.4,0,0,0-1-4.8A14.5,14.5,0,0,0,25.5,63a24.7,24.7,0,0,0-3.6-3l-4-2.8a93.1,93.1,0,0,1-7.5-5.7,30.8,30.8,0,0,1-5.7-6.2,26.9,26.9,0,0,1-3.5-7.5A32.9,32.9,0,0,1,0,28.5,35.1,35.1,0,0,1,1.7,17.6,28.2,28.2,0,0,1,6.5,8.5a22.7,22.7,0,0,1,7.9-6.2A24.7,24.7,0,0,1,25.3,0a31.3,31.3,0,0,1,8.8,1.2,36.9,36.9,0,0,1,8.2,3.5V23.4Z"/><path d="M95.9,1.5l23.3,96.9H98.7L95.1,82.1H75.7L72.2,98.5h-19L75.7,1.5H95.9ZM87.4,41.1L85.2,26.5H85L82.9,41.1,78.8,67H92.3Z"/><path d="M132.4,1.5L144,48.1a57,57,0,0,1,1.9,8.3q0.6,4.2,1.5,8.3h0.3q0.8-4.2,1.3-8.4a59.5,59.5,0,0,1,1.7-8.4L162.3,1.5h20.1L155.5,98.5H139.8l-28-96.9h20.6Z"/><path d="M228.8,1.5v18H209.4V40.6h17.1v18H209.4V80.5H229v18H190.2V1.5h38.6Z"/><path d="M259.5,50v9.3h-7.8V100h-9.9V59.3H234V50h25.5Z"/><path d="M273.9,50V69.6h10V50h9.9v50h-9.9V78.8h-10V100H264V50h9.9Z"/><path d="M320.7,50v9.3h-10V70.2h8.8v9.3h-8.8V90.7h10.1V100h-20V50h19.9Z"/></svg>
			<div class="space"></div>
			<p>Developed by<br><span class="b">Maki</span> &amp; <span class="b">Maxim</span></p>
			<div class="space"></div>
			<p><span class="b">Themes:</span></p>
			<form id="select">
				<input type="radio" name="theme" onclick="changeTheme('minecraft')" checked>The Baby<br>
				<input type="radio" name="theme" onclick="changeTheme('csgo')">Counter-Strike<br>	
				<input type="radio" name="theme" onclick="changeTheme('shrek')">Shrek &amp; Donkey<br>
				<input type="radio" name="theme" onclick="changeTheme('the_forest')">The Forest<br>
				<input type="radio" name="theme" onclick="changeTheme('yuruyuri')">Yuru Yuri<br>
				<!-- <input type="radio" name="theme" onclick="changeTheme('the_mall')">The Mall (I CANT FIND A GOOD PICTURE)<br> -->
			</form>
			<div class="space"></div>
			<p><span class="b">Online:</span> <span id="online"></span> <input type="name" id="name" placeholder="Name" style="width: 100px; float: right;"></p>
			<div class="space"></div>
			<div style="margin-left: 20px;" id="users"></div>
		</div>
		<div style="display: none;">
  		<img id="player" src="themes/minecraft/player.png">
  		<img id="bg" src="themes/minecraft/bg.png">
			<img id="want" src="fire.png">
		</div>
		<!-- <script src="https://maki.cat/socket.io/socket.io.js"></script> -->
		<script>
			// -------------
			// Node.js Stuff
			// -------------

			// var socket = io("/stb");

			// ----------------
			// Usable Functions
			// ----------------

			// function makeSoundPool(url, size) {
			// 	let pool = {
			// 		arr: [],
			// 		size: size,
			// 		current: 0
			// 	}
			
			// 	for (var i=0; i<pool.size; i++) {
			// 		let sound = new Audio(url);
			// 		sound.load();
			// 		pool.arr[i] = sound;
			// 	}
				
			// 	return pool;
			// }

			var cookie = {
				view: function(key) {
					var cookies = document.cookie.split("; ");
					for (var i=0; i<cookies.length; i++) {
						if (cookies[i].split("=")[0] == key) {
							return cookies[i].split("=")[1];
							break;
						}
					}
				},
				add: function(key, value) {
					document.cookie = key+"="+value;
				}
			}

			// ----------------
			// Global Variables
			// ----------------
		
			var canv = document.getElementById("view");
			var ctx = canv.getContext("2d");
			canv.width = 853;
			canv.height = 480;
		
			var game = {
				name: Math.random().toString(36).slice(-6),
				dead: false,
				theme: "minecraft",
				clicks: 0,
				final: {
					confirm: false,
					clicks: 0
				},
				died_sound: new Audio("died.wav")
			}
		
			var themes = {
				minecraft: {
					bg: "themes/minecraft/bg.png",
					player: "themes/minecraft/player.png",
					thing: "baby",
					sound: "themes/minecraft/sound.wav"
				},
				csgo: {
					bg: "themes/csgo/bg.png",
					player: "themes/csgo/player.png",
					thing: "gamer",
					sound: "themes/csgo/sound.wav"
				},
				// the_mall: {
				// 	bg: "themes/mall/bg.jpg",
				// 	player: "themes/mall/player.png",
				// 	thing: "terrorist"
				// },
				the_forest: {
					bg: "themes/forest/bg.jpg",
					player: "themes/forest/player.png",
					thing: "athlete"
				},
				shrek: {
					bg: "themes/shrek/bg.jpg",
					player: "themes/shrek/player.png",
					thing: "Shrek",
					sound: "themes/shrek/sound.wav"
				},
				yuruyuri: {
					bg: "themes/yuruyuri/bg.png",
					player: "themes/yuruyuri/player.png",
					thing: "Akarin",
					sound: "themes/yuruyuri/sound.wav"
				}
			}
			
			var obj = {
				player: {
					y: canv.height-260,
					x: canv.width-160,
					xi: canv.width-160,
					s: 8,
					w: 300,
					h: 200
				},
				want: {
					w: 350,
					h: 350,
					x: -50,
					y: canv.height-300
				}
			}
			
			// -----------------
			// Running Functions
			// -----------------
			
			function keyUp(e) {
				switch(e.keyCode) {
					case 32:
						obj.player.x = obj.player.xi;
						new Audio(themes[game.theme].sound).play();
						game.clicks++;
						break;
				}
			}
			
			function update() {
				if (game.dead) {
					ctx.fillStyle = "#1d1f21";
					ctx.fillRect(0, 0, canv.width, canv.height);
					
					ctx.font = "96px Vibur";
					ctx.fillStyle = "#FFF";
					ctx.textAlign = "center";
					ctx.fillText("The "+themes[game.theme]["thing"]+" died.", canv.width/2, (canv.height+48)/2, canv.width);					
					ctx.font = "400 32px Roboto";
					ctx.fillStyle = "#FFF";
					ctx.textAlign = "center";
					ctx.fillText("You saved the "+themes[game.theme]["thing"]+", "+game.final.clicks+" times!", canv.width/2, canv.height-32, canv.width);
				} else {
					ctx.drawImage(document.getElementById("bg"), 0, 0, canv.width, canv.height);
					ctx.drawImage(document.getElementById("want"), obj.want.x, obj.want.y, obj.want.w, obj.want.h);
					ctx.drawImage(document.getElementById("player"), obj.player.x, obj.player.y, obj.player.w, obj.player.h);
					
					ctx.font = "400 32px Roboto";
					ctx.fillStyle = "#FFF";
					ctx.textAlign = "center";
					ctx.fillText("You saved the "+themes[game.theme]["thing"]+", "+game.clicks+" times!", canv.width/2, 48, canv.width-48);
				}
				
				if (obj.player.x <= -200) {
					game.dead = true;
					if (!game.final.confirm) {
						game.final.clicks = game.clicks;
						game.died_sound.play();
					}
					game.final.confirm = true;
					game.clicks = -1;
				} else {
					game.dead = false;
					obj.player.x -= obj.player.s;
					game.final.confirm = false;
				}
				
			}
			
			function changeTheme(theme) {
				document.getElementById("bg").src = themes[theme].bg;
				document.getElementById("player").src = themes[theme].player;
				document.getElementById("thing").innerHTML = themes[theme].thing;
				game.theme = theme;
			}

			function fupdate() {
				if (game.dead) { clicks = game.final.clicks; } else { clicks = game.clicks; }
				// socket.emit("data", {
				// 	name: game.name,
				// 	clicks: clicks
				// });
			}

			// --------------
			// Site Scripting
			// --------------

			if (cookie.view("name") != undefined) {
				game.name = cookie.view("name");
			} else {
				cookie.add("name", game.name);
			}

			document.getElementById("name").value = game.name;

			document.getElementById("name").addEventListener("change", function() {
				game.name = document.getElementById("name").value;
				cookie.add("name", game.name);
			});

			// socket.on("info", function(obj) {
			// 	document.getElementById("online").innerHTML = obj.online;
			// 	document.getElementById("users").innerHTML = "";
			// 	for (var i=0; i<Object.keys(obj.users).length; i++) {
			// 		var name = Object.keys(obj.users)[i];
			// 		var clicks = obj.users[name];
			// 		document.getElementById("users").innerHTML += "<p><span class='b'>"+name+":</span> "+clicks+" saves</p>";
			// 	}
			// });

			// ----------
			// Game Start
			// ----------

			window.onload = function() {
				document.addEventListener("keyup", keyUp);
				setInterval(update, 1000/60);
				setInterval(fupdate, 250);
			}

		</script>
	</body>
</html>